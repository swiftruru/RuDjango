{% extends 'blog/base.html' %}
{% load static %}
{% load blog_extras %}

{% block title %}{{ tag.name }} - æ¨™ç±¤æ–‡ç«  - RuDjango{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'blog/css/articles/list.css' %}">
<link rel="stylesheet" href="{% static 'blog/css/tags.css' %}">
{% endblock %}

{% block content %}
<div class="tag-articles-container">
    <!-- æ¨™ç±¤æ¨™é¡Œ -->
    <div class="tag-header">
        <h1 class="tag-title">
            <span class="tag-icon">ğŸ·ï¸</span>
            {{ tag.name }}
        </h1>
        {% if tag.description %}
        <p class="tag-description">{{ tag.description }}</p>
        {% endif %}
        <p class="tag-count">å…± {{ total_articles }} ç¯‡æ–‡ç« </p>
    </div>

    <!-- å°èˆªæŒ‰éˆ• -->
    <div class="tag-navigation">
        <a href="{% url 'tags_list' %}" class="btn-back">â† è¿”å›æ¨™ç±¤åˆ—è¡¨</a>
        <a href="{% url 'blog_home' %}" class="btn-home">è¿”å›é¦–é </a>
    </div>

    <!-- æ–‡ç« åˆ—è¡¨ -->
    {% if articles %}
    <div class="articles-grid">
        {% for article in articles %}
        <article class="article-card">
            <div class="article-header">
                <h3 class="article-title">
                    <a href="{% url 'article_detail' article.id %}">
                        {{ article.title|truncatechars:50 }}
                    </a>
                </h3>
                <time class="article-date">{{ article.created_at|date:"Yå¹´mæœˆdæ—¥" }}</time>
            </div>
            <div class="article-content">
                <p>{{ article.content|markdown|truncatewords_html:30 }}</p>
            </div>
            <div class="article-footer">
                <div class="article-footer-info">
                    <span class="article-time">ğŸ“… {{ article.created_at|date:"Y-m-d H:i" }}</span>
                    {% if article.author %}
                    <span class="author-name">âœï¸ <a href="{% url 'member_profile' username=article.author.username %}" class="author-link">{{ article.author|author_display }}</a></span>
                    {% endif %}
                </div>
                <div class="article-footer-link">
                    <a href="{% url 'article_detail' article.id %}">é–±è®€æ›´å¤š â†’</a>
                </div>
            </div>
            {% if article.tags.all %}
            <div class="article-tags">
                {% for tag_item in article.tags.all %}
                <a href="{% url 'tag_articles' tag_item.slug %}" class="tag {% if tag_item.id == tag.id %}tag-current{% endif %}">
                    ğŸ·ï¸ {{ tag_item.name }}
                </a>
                {% endfor %}
            </div>
            {% endif %}
        </article>
        {% endfor %}
    </div>

    <!-- åˆ†é  -->
    {% if articles.has_other_pages %}
    <div class="pagination">
        {% if articles.has_previous %}
        <a href="?page=1" class="page-link">Â« é¦–é </a>
        <a href="?page={{ articles.previous_page_number }}" class="page-link">â€¹ ä¸Šä¸€é </a>
        {% endif %}

        <span class="page-current">ç¬¬ {{ articles.number }} / {{ articles.paginator.num_pages }} é </span>

        {% if articles.has_next %}
        <a href="?page={{ articles.next_page_number }}" class="page-link">ä¸‹ä¸€é  â€º</a>
        <a href="?page={{ articles.paginator.num_pages }}" class="page-link">æœ«é  Â»</a>
        {% endif %}
    </div>
    {% endif %}
    {% else %}
    <div class="no-articles">
        <p>ğŸ“­ æ­¤æ¨™ç±¤ç›®å‰é‚„æ²’æœ‰æ–‡ç« </p>
        <a href="{% url 'article_create' %}" class="btn-create">ç™¼è¡¨æ–‡ç« </a>
    </div>
    {% endif %}
</div>
{% endblock %}
