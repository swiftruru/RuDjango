{% extends 'blog/base.html' %}
{% load static blog_extras %}

{% block title %}ç·¨è¼¯å€‹äººè³‡æ–™{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'blog/css/members/edit_profile.css' %}">
{% endblock %}

{% block content %}
<div class="edit-profile-container">
    <div class="edit-card">
        <h1>ç·¨è¼¯å€‹äººè³‡æ–™</h1>
        <p>æ›´æ–°æ‚¨çš„å€‹äººè³‡è¨Šï¼Œè®“å…¶ä»–æœƒå“¡æ›´äº†è§£æ‚¨</p>

        <form method="post" enctype="multipart/form-data">
            {% csrf_token %}

            <!-- åŸºæœ¬è³‡æ–™ -->
            <div class="form-section">
                <h2>åŸºæœ¬è³‡æ–™</h2>

                <div class="form-group">
                    <label for="{{ form.first_name.id_for_label }}">{{ form.first_name.label }}</label>
                    {{ form.first_name }}
                    {% if form.first_name.errors %}
                    {{ form.first_name.errors }}
                    {% endif %}
                </div>

                <div class="form-group">
                    <label for="{{ form.email.id_for_label }}">{{ form.email.label }}</label>
                    {{ form.email }}
                    {% if form.email.errors %}
                    {{ form.email.errors }}
                    {% endif %}
                </div>

                <div class="form-group">
                    <label for="{{ form.bio.id_for_label }}">{{ form.bio.label }}</label>
                    {{ form.bio }}
                    {% if form.bio.errors %}
                    {{ form.bio.errors }}
                    {% endif %}
                </div>

                <div class="form-group">
                    <label for="{{ form.avatar.id_for_label }}">{{ form.avatar.label }}</label>

                    <!-- é ­åƒé è¦½å€ -->
                    <div class="avatar-preview-container">
                        <div class="avatar-preview">
                            {% if profile.avatar %}
                            <img src="{{ profile|avatar_url }}" alt="Current Avatar" id="avatar-preview-img">
                            {% else %}
                            <img src="{% static 'blog/images/å¤§é ­ç¶ .JPG' %}" alt="Default Avatar" id="avatar-preview-img">
                            {% endif %}
                        </div>
                        <div class="avatar-upload-info">
                            <!-- æ‹–æ›³ä¸Šå‚³å€ -->
                            <div class="drop-zone" id="drop-zone">
                                <div class="drop-zone-icon">ğŸ“¤</div>
                                <div class="drop-zone-text">
                                    <strong>æ‹–æ›³åœ–ç‰‡åˆ°é€™è£¡</strong>
                                    <span>æˆ–é»æ“Šä¸‹æ–¹æŒ‰éˆ•é¸æ“‡æª”æ¡ˆ</span>
                                </div>
                                <div class="drop-zone-filename" id="drop-zone-filename"></div>
                            </div>

                            <div class="file-upload-wrapper">
                                <input type="file" id="{{ form.avatar.id_for_label }}" name="{{ form.avatar.name }}"
                                    class="file-input" accept="image/*">
                                <label for="{{ form.avatar.id_for_label }}" class="file-upload-label">
                                    <span class="file-upload-icon">ğŸ“·</span>
                                    <span class="file-upload-text">é¸æ“‡é ­åƒåœ–ç‰‡</span>
                                </label>
                            </div>
                            <p class="form-help">å»ºè­°ä½¿ç”¨æ­£æ–¹å½¢åœ–ç‰‡ï¼Œå¤§å°ä¸è¶…é 5MB</p>
                        </div>
                    </div>

                    {% if form.avatar.errors %}
                    {{ form.avatar.errors }}
                    {% endif %}
                </div>
            </div>

            <!-- æ•™è‚²è³‡è¨Š -->
            <div class="form-section">
                <h2>æ•™è‚²è³‡è¨Š</h2>

                <div class="form-group">
                    <label for="{{ form.school.id_for_label }}">{{ form.school.label }}</label>
                    {{ form.school }}
                    {% if form.school.errors %}
                    {{ form.school.errors }}
                    {% endif %}
                </div>

                <div class="form-group">
                    <label for="{{ form.grade.id_for_label }}">{{ form.grade.label }}</label>
                    {{ form.grade }}
                    {% if form.grade.errors %}
                    {{ form.grade.errors }}
                    {% endif %}
                </div>

                <div class="form-group">
                    <label for="{{ form.birthday.id_for_label }}">{{ form.birthday.label }}</label>
                    {{ form.birthday }}
                    {% if form.birthday.errors %}
                    {{ form.birthday.errors }}
                    {% endif %}
                </div>
            </div>

            <!-- å…¶ä»–è³‡è¨Š -->
            <div class="form-section">
                <h2>å…¶ä»–è³‡è¨Š</h2>

                <div class="form-group">
                    <label for="{{ form.location.id_for_label }}">{{ form.location.label }}</label>
                    {{ form.location }}
                    {% if form.location.errors %}
                    {{ form.location.errors }}
                    {% endif %}
                </div>

                <div class="form-group">
                    <label for="{{ form.website.id_for_label }}">{{ form.website.label }}</label>
                    {{ form.website }}
                    {% if form.website.errors %}
                    {{ form.website.errors }}
                    {% endif %}
                </div>

                <div class="form-group">
                    <label for="{{ form.github.id_for_label }}">{{ form.github.label }}</label>
                    {{ form.github }}
                    {% if form.github.errors %}
                    {{ form.github.errors }}
                    {% endif %}
                    <p class="form-help">åªéœ€è¼¸å…¥ä½¿ç”¨è€…åç¨±ï¼Œä¸éœ€è¦å®Œæ•´ç¶²å€</p>
                </div>
            </div>

            <!-- æŠ€èƒ½æ¨™ç±¤ -->
            <div class="form-section">
                <h2>æŠ€èƒ½æ¨™ç±¤</h2>

                <div class="form-group">
                    <label for="skill-input">æŠ€èƒ½æ¨™ç±¤</label>
                    <p class="form-help">è¼¸å…¥æŠ€èƒ½å¾ŒæŒ‰ Enterã€é€—è™Ÿæˆ–åˆ†è™Ÿæ–°å¢ï¼Œé»æ“Šæ¨™ç±¤å¯åˆªé™¤</p>

                    <!-- å¸¸è¦‹æŠ€èƒ½å¿«é€Ÿé¸æ“‡ -->
                    <div class="quick-skills">
                        <p>å¿«é€Ÿé¸æ“‡ï¼š</p>
                        <div class="quick-skills-grid">
                            <button type="button" class="quick-skill-btn" data-skill="Python">Python</button>
                            <button type="button" class="quick-skill-btn" data-skill="Django">Django</button>
                            <button type="button" class="quick-skill-btn" data-skill="JavaScript">JavaScript</button>
                            <button type="button" class="quick-skill-btn" data-skill="HTML">HTML</button>
                            <button type="button" class="quick-skill-btn" data-skill="CSS">CSS</button>
                            <button type="button" class="quick-skill-btn" data-skill="React">React</button>
                            <button type="button" class="quick-skill-btn" data-skill="Vue.js">Vue.js</button>
                            <button type="button" class="quick-skill-btn" data-skill="Node.js">Node.js</button>
                            <button type="button" class="quick-skill-btn" data-skill="SQL">SQL</button>
                            <button type="button" class="quick-skill-btn" data-skill="Git">Git</button>
                            <button type="button" class="quick-skill-btn" data-skill="Docker">Docker</button>
                            <button type="button" class="quick-skill-btn" data-skill="æ©Ÿå™¨å­¸ç¿’">æ©Ÿå™¨å­¸ç¿’</button>
                        </div>
                    </div>

                    <!-- æŠ€èƒ½æ¨™ç±¤é¡¯ç¤ºå€ -->
                    <div id="skills-display" class="skills-display">
                        <!-- æŠ€èƒ½æ¨™ç±¤å°‡åœ¨é€™è£¡å‹•æ…‹é¡¯ç¤º -->
                    </div>

                    <!-- è¼¸å…¥æ¡† -->
                    <input type="text" id="skill-input" class="form-control" placeholder="è¼¸å…¥è‡ªè¨‚æŠ€èƒ½...">

                    <!-- éš±è—çš„è¡¨å–®å­—æ®µç”¨æ–¼æäº¤ -->
                    <input type="hidden" name="skills" id="skills-hidden" value="{{ form.skills.value|default:'' }}">

                    {% if form.skills.errors %}
                    {{ form.skills.errors }}
                    {% endif %}
                </div>
            </div>

            <div class="form-actions">
                <button type="submit" class="btn btn-primary">å„²å­˜è®Šæ›´</button>
                <a href="{% url 'member' %}" class="btn btn-secondary">å–æ¶ˆ</a>
            </div>
        </form>

        <!-- å®‰å…¨æ€§è¨­å®š -->
        <div class="form-section" style="margin-top: 2rem; padding-top: 2rem; border-top: 2px solid #e5e7eb;">
            <h2>å®‰å…¨æ€§è¨­å®š</h2>
            <p style="color: #6b7280; margin-bottom: 1rem;">ç®¡ç†æ‚¨çš„å¸³è™Ÿå®‰å…¨</p>
            <a href="{% url 'change_password' %}" class="btn btn-secondary" style="display: inline-block;">
                ğŸ”’ æ›´æ”¹å¯†ç¢¼
            </a>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'blog/js/members/edit_profile.js' %}"></script>
{% endblock %}