{% extends 'blog/base.html' %}
{% load static %}

{% block title %}{{ member.name }} çš„æˆå°±å¾½ç« {% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'blog/css/members/achievements.css' %}">
{% endblock %}

{% block content %}
<!-- Page Header -->
<section class="page-header">
    <div class="container">
        <div class="header-content">
            <a href="{% url 'member_profile' username=member.username %}" class="back-link">
                â† è¿”å›å€‹äººè³‡æ–™
            </a>
            <h1 class="page-title">æˆå°±å¾½ç« </h1>
            <p class="page-subtitle">{{ member.name }} çš„æˆå°±æ”¶è—</p>
        </div>

        <!-- Progress Stats -->
        <div class="progress-stats">
            <div class="stat-item">
                <span class="stat-label">ç¸½æˆå°±æ•¸</span>
                <span class="stat-value">{{ total_achievements }}</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">å·²è§£é–</span>
                <span class="stat-value unlock-count">{{ unlocked_count }}</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">å®Œæˆåº¦</span>
                <span class="stat-value">{{ unlock_percentage }}%</span>
            </div>
        </div>

        <!-- Progress Bar -->
        <div class="overall-progress">
            <div class="progress-bar">
                <div class="progress-fill" style="width: {{ unlock_percentage }}%;"></div>
            </div>
        </div>
    </div>
</section>

<!-- Achievements Grid -->
<section class="achievements-section">
    <div class="container">
        {% for category_name, achievements in categories.items %}
        <div class="category-section">
            <h2 class="category-title">{{ category_name }}</h2>
            <div class="achievements-grid">
                {% for data in achievements %}
                <div class="achievement-card {% if data.is_unlocked %}unlocked{% else %}locked{% endif %}"
                     data-achievement-id="{{ data.achievement.id }}">
                    <div class="achievement-icon">
                        {{ data.achievement.icon }}
                    </div>
                    <div class="achievement-content">
                        <h3 class="achievement-name">{{ data.achievement.name }}</h3>
                        <p class="achievement-desc">{{ data.achievement.description }}</p>

                        {% if data.is_unlocked %}
                        <div class="achievement-footer unlocked">
                            <span class="achievement-status">
                                <span class="status-icon">âœ“</span>
                                å·²è§£é–
                            </span>
                            <span class="achievement-date">
                                {{ data.unlocked_at|date:"Y-m-d" }}
                            </span>
                        </div>
                        <div class="achievement-points">
                            +{{ data.achievement.points }} XP
                        </div>
                        {% else %}
                        <div class="achievement-footer locked">
                            <span class="achievement-status">
                                <span class="status-icon">ğŸ”’</span>
                                æœªè§£é–
                            </span>
                        </div>
                        <div class="achievement-points locked-points">
                            +{{ data.achievement.points }} XP
                        </div>
                        {% endif %}
                    </div>

                    {% if data.is_unlocked %}
                    <div class="unlock-effect"></div>
                    {% endif %}
                </div>
                {% endfor %}
            </div>
        </div>
        {% empty %}
        <div class="empty-state">
            <div class="empty-icon">ğŸ†</div>
            <p class="empty-text">ç›®å‰é‚„æ²’æœ‰ä»»ä½•æˆå°±</p>
            <p class="empty-hint">ç®¡ç†å“¡å¯ä»¥åœ¨å¾Œå°æ–°å¢æˆå°±</p>
        </div>
        {% endfor %}
    </div>
</section>

<!-- Achievement Details Modal (Optional) -->
<div id="achievement-modal" class="modal" style="display: none;">
    <div class="modal-overlay"></div>
    <div class="modal-content">
        <button class="modal-close">âœ•</button>
        <div class="modal-body">
            <div class="modal-icon"></div>
            <h2 class="modal-title"></h2>
            <p class="modal-description"></p>
            <div class="modal-meta">
                <span class="modal-category"></span>
                <span class="modal-points"></span>
            </div>
        </div>
    </div>
</div>

{% block extra_js %}
<script src="{% static 'blog/js/members/achievements.js' %}"></script>
{% endblock %}
{% endblock %}
