{% extends 'blog/base.html' %}
{% load static %}

{% block title %}è¿‘æœŸæ´»å‹• - {{ member.name }}{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'blog/css/members/activities.css' %}">
{% endblock %}

{% block content %}
<!-- Page Header -->
<section class="page-header">
    <div class="container">
        <div class="header-content">
            <a href="{% url 'member_profile' username=member.username %}" class="back-link">
                <span class="back-icon">â†</span>
                è¿”å›å€‹äººé é¢
            </a>
            <h1 class="page-title">è¿‘æœŸæ´»å‹•</h1>
            <p class="page-subtitle">æŸ¥çœ‹ {{ member.name }} çš„æ‰€æœ‰å‹•æ…‹è¨˜éŒ„</p>
        </div>
    </div>
</section>

<!-- Activities Content -->
<section class="activities-content">
    <div class="container">
        <div class="activities-wrapper">
            <!-- Filter Tabs -->
            <div class="filter-tabs">
                <button class="filter-tab active" data-filter="all">
                    <span class="tab-icon">ğŸ“‹</span>
                    å…¨éƒ¨æ´»å‹•
                </button>
                <button class="filter-tab" data-filter="post">
                    <span class="tab-icon">ğŸ“</span>
                    ç™¼è¡¨æ–‡ç« 
                </button>
                <button class="filter-tab" data-filter="comment">
                    <span class="tab-icon">ğŸ’¬</span>
                    è©•è«–
                </button>
                <button class="filter-tab" data-filter="achievement">
                    <span class="tab-icon">ğŸ†</span>
                    æˆå°±
                </button>
                <button class="filter-tab" data-filter="course">
                    <span class="tab-icon">ğŸ“š</span>
                    å­¸ç¿’
                </button>
                <button class="filter-tab" data-filter="level_up">
                    <span class="tab-icon">â¬†ï¸</span>
                    å‡ç´š
                </button>
            </div>

            <!-- Activities List -->
            <div class="activities-list">
                {% for activity in activities %}
                <div class="activity-card" data-type="{{ activity.activity_type }}">
                    <div class="activity-date">
                        <div class="date-day">{{ activity.created_at|date:"d" }}</div>
                        <div class="date-month">{{ activity.created_at|date:"M" }}</div>
                    </div>
                    <div class="activity-icon-wrapper">
                        <div class="activity-icon">{{ activity.icon }}</div>
                    </div>
                    <div class="activity-details">
                        <div class="activity-header">
                            <h3 class="activity-title">
                                {% if activity.activity_type == 'post' and activity.get_related_object %}
                                    {% with article=activity.get_related_object %}
                                        ç™¼è¡¨äº†æ–‡ç« ã€Š<a href="{% url 'article_detail' id=article.id %}" class="article-link">{{ article.title }}</a>ã€‹
                                    {% endwith %}
                                {% elif activity.activity_type == 'comment' and activity.get_related_object %}
                                    {% with comment=activity.get_related_object %}
                                        è©•è«–äº†æ–‡ç« ã€Š<a href="{% url 'article_detail' id=comment.article.id %}" class="article-link">{{ comment.article.title }}</a>ã€‹
                                    {% endwith %}
                                {% else %}
                                    {{ activity.title }}
                                {% endif %}
                            </h3>
                            <span class="activity-type-badge {{ activity.activity_type }}">
                                {{ activity.get_activity_type_display }}
                            </span>
                        </div>
                        {% if activity.description %}
                        <p class="activity-description">{{ activity.description }}</p>
                        {% endif %}
                        <div class="activity-meta">
                            <span class="activity-time">{{ activity.created_at|date:"Yå¹´mæœˆdæ—¥ H:i" }}</span>
                        </div>
                    </div>
                </div>
                {% empty %}
                <div class="empty-state">
                    <div class="empty-icon">ğŸ“­</div>
                    <h3 class="empty-title">å°šç„¡æ´»å‹•è¨˜éŒ„</h3>
                    <p class="empty-text">é–‹å§‹ä½¿ç”¨å¹³å°ï¼Œä½ çš„æ´»å‹•è¨˜éŒ„å°‡æœƒé¡¯ç¤ºåœ¨é€™è£¡</p>
                </div>
                {% endfor %}
            </div>

            <!-- Pagination -->
            {% if page_obj.paginator.num_pages > 1 %}
            <div class="pagination">
                {% if page_obj.has_previous %}
                <a href="?page=1" class="page-link">
                    Â« é¦–é 
                </a>
                <a href="?page={{ page_obj.previous_page_number }}" class="page-link">
                    â€¹ ä¸Šä¸€é 
                </a>
                {% endif %}

                {% for num in page_obj.paginator.page_range %}
                {% if page_obj.number == num %}
                <span class="page-current">
                    {{ num }}
                </span>
                {% elif num > page_obj.number|add:'-3' and num < page_obj.number|add:'3' %}
                <a href="?page={{ num }}" class="page-link">
                    {{ num }}
                </a>
                {% endif %}
                {% endfor %}

                {% if page_obj.has_next %}
                <a href="?page={{ page_obj.next_page_number }}" class="page-link">
                    ä¸‹ä¸€é  â€º
                </a>
                <a href="?page={{ page_obj.paginator.num_pages }}" class="page-link">
                    æœ«é  Â»
                </a>
                {% endif %}
            </div>
            {% endif %}
        </div>
    </div>
</section>
{% endblock %}

{% block extra_js %}
<script src="{% static 'blog/js/members/activities.js' %}"></script>
{% endblock %}